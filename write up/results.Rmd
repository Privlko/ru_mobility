---
title: "Class, mobility, and earnings"
author: ""
date: "19 May 2019"
output:
  pdf_document: default
  word_document: default

---

## Results


This section outlines the main results of the paper. First, I explore the prominence of mobility in the sample. Second I outline the wage differences between movers and non-movers. Third, I present the results of four fixed-effects linear models which estimate the effect of mobility on earnings, controlling for a range of time-variant measures. For each section, I consider the social class differences in mobility, earnings, and both, as well as the overall differences. I conclude the section with a brief discussion of the hypotheses.  

### Mobility types

Table 1 presents mobility statistics in two ways, between observations, and between respondents. Columns 1, 2, and 3 consider observations. In total, 79% of all responses capture instances where people remain in the same job with the same employer. 4% of observations capture promotions, 1% capture a lateral move, and 15% capture an exit from the firm, either voluntary or involuntary. Columns 4,5, and 6 consider respondents. Between respondents 88% experience staying in the same job with the same employer at least once during the study. Further, 10% experience a promotion at least once, and 3% experience a lateral move (within the firm) at least once. Finally 31% of respondents experience an exit from the firm, wither voluntary or involuntary, at least once during the study. 


```{r, warning=F, echo=FALSE, message=FALSE, error=FALSE}
ru3 <- readRDS("~/ru_mobility/ru_data.rds")

library(tidyverse)
library(knitr)

t1 <- ru3 %>%
  filter(!is.na(mob_final)) %>% 
  group_by(mob_final) %>% 
  summarise(obs = n()) %>% 
  mutate(obs_total = sum(obs),
         freq = obs/sum(obs),
         obs_pct=round(freq*100,2)) %>% 
  select(mob_final, obs, obs_total, obs_pct)

t1 <- ru3 %>% 
  filter(!is.na(mob_final)) %>%
  mutate(resp_total = length(unique(idind))) %>% 
  group_by(mob_final) %>% 
  summarise(resp_total = min(resp_total),
            resp= length(unique(idind))) %>%
  mutate(freq=resp/resp_total,
         resp_pct=round(freq*100,2)) %>% 
  bind_cols(t1) %>% 
 select(mob_final, obs, obs_total, obs_pct,
         resp, resp_total, resp_pct)


t1 %>% 
  rename('Mobility type'= mob_final,
         'Total' = resp_total,
         'Respondents' = resp,
         'Percent' = resp_pct,
         'Observations' = obs,
         'Total' = obs_total,
         'Percent' = obs_pct) %>%
  kable(format.args = list(decimal.mark = '.', big.mark = ","),
        caption = "Mobility types, overall")

``` 

Three points are worth mentioning about Table 1. First, the majority of respondents do not change jobs. Most workers remain in the same job with the same employer. Second, when respondents do change jobs, they are most likely to change employers as well as jobs. The most common form of mobility in the sample is exit to a new employer or firm. This mobility likely contains a mix of voluntary (quits to new opportunities) and involuntary (redundancy, dismissal, firm closure etc.) changes. Lastly, Promotions, which are voluntary forms of mobility, occur rarely in the data, suggesting they are unique opportunities for workers. This does not mean that exit to a new employer cannot provide earnings premiums to workers, the literature suggests that quits to a new employer, expecially when they are direct changes, can yield significant earnings growth and premiums. However, such changes are impossible to isolate in the RLMS survey. Instead these changes sit within the exit category.

Social class groups experience unequal chances of exit, lateral changes, and promotion. As Goldthorpe (ref) suggests, high social class groups are tied to "service relationships" with their employers, who sees these workers as an investment to be secured over the long-term. Meanwhile, employers see low social class groups as "contractual agreements", where compensation is tied to pay on a short-term basis. For this reason, we will split mobility across three broad social class groups, mentioned earlier. It should be noted that mobility between social class groups also exists, although it is generally rare. 
\newpage


```{r, warning=F, echo=FALSE, message=FALSE, error=FALSE}


t1.5 <- ru3 %>%
  filter(!is.na(mob_final),
         !is.na(esec_simple)) %>% 
  group_by(esec_simple, mob_final) %>% 
  summarise(obs = n()) %>% 
  mutate(obs_total = sum(obs),
         freq = obs/sum(obs),
         obs_pct=round(freq*100,2)) %>% 
  select(mob_final, obs, obs_total, obs_pct)


t1.5 <- ru3 %>% 
  filter(!is.na(mob_final),
         !is.na(esec_simple)) %>%
  group_by(esec_simple) %>% 
  mutate(resp_total = length(unique(idind))) %>% 
  group_by(esec_simple, mob_final) %>% 
  summarise(resp_total = min(resp_total),
            resp= length(unique(idind))) %>%
  mutate(freq=resp/resp_total,
         resp_pct=round(freq*100,2)) %>% 
  bind_cols(t1.5) %>% 
 select(mob_final, obs, obs_total, obs_pct,
         resp, resp_total, resp_pct)


t1.5 %>% 
  select(esec_simple, mob_final, resp:resp_pct) %>% 
  rename('Mobility type'= mob_final,
         "Social class" = esec_simple,
         'Total' = resp_total,
         'Respondents' = resp,
         'Percent' = resp_pct) %>%
  kable(format.args = list(decimal.mark = '.', big.mark = ","),
        caption = "Mobility types, by social class")

``` 

In this section, we will focus only on class differences between respondents, for clarity. Starting with the High social class group, 22% of these respondents experience employment exit at least once, and 15% of these respondents experience a promotion at least once. These changes are unique when compared to Middle class respondents. Here, just 7% of respondents experience a promotion, and 27% experience an exit. Among middle class respondents, promotion is less likely and exit is more likely than High class EsEC groups. Working class respondents have even starker differences, just 3% of these respondents experience a promotion, and 35% of respondents experience an employer exit to a new positions. Lateral moves within firms are eually unlikely for all respondents. Overall, there is a clear hierarchy to a worker's chances of experiencing promotion within a five year period. 

### Mobility and earnings

This section considers earnings differences between movers and non-movers. It also considers this difference between social class groups.  

```{r warning=F, echo=FALSE, message=FALSE, error=FALSE}

t2 <- ru3 %>%
  filter(!is.na(ever_promoted),
         !is.na(wage)) %>% 
  group_by(ever_promoted) %>% 
  summarise(ever_promoted_median = median(wage, na.rm=TRUE),
            ever_promoted_mean_wage =mean(wage, na.rm=TRUE)) 

t2 <- ru3 %>%
  filter(!is.na(ever_exit),
         !is.na(wage)) %>% 
  group_by(ever_exit) %>% 
  summarise(ever_exit_median = median(wage, na.rm=TRUE),
            ever_exit_mean_wage =mean(wage, na.rm=TRUE)) %>% 
  bind_cols(t2) %>% 
  select(ever_promoted, ever_exit_mean_wage, ever_exit_median,
         ever_promoted_mean_wage, ever_promoted_median)

t2 %>%
  select(ever_promoted, ever_exit_mean_wage, ever_promoted_mean_wage) %>%
  rename("Change" = ever_promoted,
         "Ever exited (mean wage)" = ever_exit_mean_wage,
         "Ever promoted (mean wage)" = ever_promoted_mean_wage) %>% 
  kable(format.args = list(decimal.mark = '.', big.mark = ","))

```

The first column considers the mean wage between respondents who have experienced an early exit at least once, and those who have never experienced such a change. The second, considers the average earnings of those who were promoted even once, and the earnings of those who were never promoted. Two patterns emerge. First the earnings of movers, in both columns are typically higher than the earnings of non-movers. Second, the earnings of those who are promoted (even if only once) are higher than those never promoted. Although exits may contain a premium too, this premium is likely lower than the premium tied to promotions. As before, It's likely that there are class differences to the effect described above. We consider the preium of uits and promotions by class in the table below. 



```{r warning=F, echo=FALSE, message=FALSE, error=FALSE}

t3 <- ru3 %>%
  filter(!is.na(ever_promoted),
         !is.na(wage),
         !is.na(esec_simple)) %>% 
  group_by(esec_simple, ever_promoted) %>% 
  summarise(ever_promoted_median = median(wage, na.rm=TRUE),
            ever_promoted_mean_wage =mean(wage, na.rm=TRUE)) 

t3 <- ru3 %>%
  filter(!is.na(ever_exit),
         !is.na(wage),
         !is.na(esec_simple)) %>% 
  group_by(esec_simple, ever_exit) %>% 
  summarise(ever_exit_median = median(wage, na.rm=TRUE),
            ever_exit_mean_wage =mean(wage, na.rm=TRUE)) %>% 
  bind_cols(t3) %>% 
  select(ever_promoted, ever_exit_mean_wage, ever_promoted_mean_wage)

t3 %>%
  select(ever_promoted, ever_exit_mean_wage, ever_promoted_mean_wage) %>%
  rename("Change" = ever_promoted,
         "Ever exited (mean wage)" = ever_exit_mean_wage,
         "Ever promoted (mean wage)" = ever_promoted_mean_wage) %>% 
  kable(format.args = list(decimal.mark = '.', big.mark = ","))

```


Thinking of exiters, high EsEc groups report higher earnings among "exiters" (27,000+) than "non-exiters" (24,000+).Middle and lower class groups see no differences in earnings between "exiters"" and "non-exiters", although lower class groups may see a small difference between those who leave (19,000+) and those who remain (18,000+). 

The effect is different for respondents who receive promotions, and those who never receive promotions. In each group, those who receive at least one promotion typically report higher earnings than those never promoted (during the study). Further, this difference appears largest for high class groups (+7,000), than middle (+4,000) and low EsEC groups (+4,000). 

### Mobility's effects on earnings

Although the tables above point to interesting correlations, the difference between groups may be explained by other reasons. Job mobility is not a random event, and class differences may be capturing other, unmeasured characteristics of movers and non-movers. Further class-differences in earnings and premiums could account for other factors such as age, and managerial responsibilities, which typically fall on more senior respondents. However, the tables above suggest that mobility types differ in their effects on earnings, with promotions leading to premiums, and exits leading to minor change. Further, the tables suggest that upper class respondents are more likely to receive promotions, and receive higher benefits from promotions too. The next section considers the effects of mobility controlling for a range on factors tied to earnings inequality. 

```{r echo=FALSE, message=FALSE, warning=FALSE}

library(plm)
library(tidyverse)
library(gtools)



p1 <- ru3 %>% 
  filter(wage>0) %>% 
  pdata.frame(c("idind","round"), drop.index = FALSE, row.names = TRUE)


m5 <- plm(log(wage) ~ factor(marr_stat) + mob_final + age + firm_size + round, data = p1, model = "within")


n1 <- broom::tidy(m5) %>% 
  mutate(signif = stars.pval(p.value)) %>% 
  mutate(estimate = round(estimate, 3),
         p.value = round(p.value, 3)) %>% 
  select(term,
         estimate, 
         signif) %>% 
  rename('Term' = term,
         "Est"= estimate,
         " "= signif)



kable(n1)
```

